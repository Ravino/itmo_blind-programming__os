# Самостоятельная работа: Построение L2-сети и настройка внутреннего DNS

## Цель работы

Научиться:

* объединять несколько серверов в одну логическую L2-сеть поверх существующей IP-сети;
* использовать VPN-технологии (fastd, tinc, VXLAN) для создания оверлейных сетей;
* настраивать внутренний DNS для удобного доступа к серверам по доменным именам в выделенной зоне.

---

## Условие

Вам предоставлено **несколько виртуальных серверов** (не менее трёх). Между ними есть только стандартная L3-сеть (например, приватные IP в облаке или NAT-сеть в VirtualBox).

Ваша задача —:

1. Построить **виртуальную L2-сеть** поверх этой инфраструктуры.
   Все серверы должны оказаться в одной подсети, как если бы они были подключены к одному физическому свитчу.
2. Развернуть на одном из узлов **DNS-сервер**, который будет обслуживать внутреннюю зону `dc.local`.
   В этой зоне должны автоматически или вручную появляться имена всех серверов (`<hostname>.dc.local`).
3. Настроить резолвинг так, чтобы с любого узла можно было обратиться к другому по имени вида `nginx01.dc.local`.

---

## Часть 1. Построение L2-сети

1. Выберите один из вариантов:

   * **fastd** — простой и быстрый VPN для L2/L3 поверх UDP;
   * **tinc** — децентрализованный VPN, поддерживает mesh-топологии;
   * **VXLAN** — оверлейный протокол для построения L2-сетей поверх L3.

   *(Можно реализовать несколько способов и сравнить, но достаточно одного.)*

2. Реализуйте схему:

   * Настройте VPN/overlay на всех серверах.
   * Создайте интерфейсы (например, `vxlan100` или `tinc0`).
   * Сведите интерфейсы в bridge (`br0`), чтобы они стали частью одной L2-сети.
   * Назначьте каждому серверу адрес из общей подсети, например `10.100.0.0/24`.

3. Убедитесь, что:

   * все сервера видят друг друга по ARP (`arp -a` должен показывать MAC-адреса соседей);
   * `ping` по внутренним IP работает между всеми узлами;
   * сеть действительно L2, а не просто набор туннелей.

---

## Часть 2. DNS-сервер

1. Выберите DNS-сервер:

   * **bind9** (классический DNS-сервер, поддержка зон, динамических обновлений);
   * **dnsmasq** (лёгкий сервер, совмещает DHCP и DNS, удобен для небольших сетей).

2. Настройте зону `dc.local`:

   * Каждому серверу выдайте имя вида `<hostname>.dc.local`.
   * Примеры: `nginx01.dc.local`, `db01.dc.local`, `studentpc.dc.local`.
   * В зоне должны быть A-записи с IP из вашей новой L2-сети.

3. Настройте все узлы так, чтобы они использовали этот DNS-сервер.

   * Проверьте, что команды `dig` или `host` возвращают корректные IP.
   * Проверьте, что можно `ping` по доменному имени.

---

## Часть 3. Артефакты и оформление

1. В отдельном репозитории разместите:

   * конфигурационные файлы (`fastd.conf`, `tinc.conf`, `systemd-networkd`-файлы, `bind9`-зоны и т. д.);
   * скрипты для запуска/остановки сервисов;
   * документацию в `README.md`.

2. В `README.md` должно быть:

   * **Краткое описание топологии** (какие узлы, какие IP, какой софт используется);
   * **Пошаговое руководство**, как развернуть сеть и DNS с нуля;
   * **Результаты проверки** в текстовом виде:

     * вывод `ip addr show` с новыми интерфейсами;
     * вывод `bridge link` или `ip link show type vxlan`;
     * вывод `ping` между узлами;
     * вывод `dig nginx01.dc.local`.

3. **Важно:** никаких скриншотов. Все результаты должны быть в текстовом виде, либо как лог выполнения команд, либо как отдельные `.txt` файлы в репозитории.

---

## Критерии оценки

* **50%** — корректно реализована L2-сеть, узлы пингуются и видят друг друга по ARP.
* **30%** — DNS-сервер поднят и обслуживает зону `dc.local`.
* **20%** — все узлы могут обращаться друг к другу по доменным именам.

---

